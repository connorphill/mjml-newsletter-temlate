{"version":3,"sources":["../src/documentParser.js"],"names":[],"mappings":";;;;;;;;;;;;;;;;AAIA,IAAM,YAAY;;;;;AAIhB,gDAAkB,MAAM;AACtB,QAAI,CAAC,IAAD,EAAO;AACT,YAAM,4BAAqB,yCAArB,CAAN,CADS;KAAX;;AAIA,QAAM,OAAO,UAAU,iBAAV,CALS;AAMtB,QAAM,UAAU,KAAK,OAAL,CANM;AAOtB,QAAM,aAAa,KAAK,OAAL,CAPG;AAQtB,QAAI,mBAAJ,CARsB;;AAUtB,QAAM,WAAW,KAAK,UAAL,GACT,KAAK,UAAL,CAAgB,MAAhB,CAAuB;aAAS,MAAM,OAAN;KAAT,CAAvB,CAA+C,GAA/C,CAAmD,IAAnD,CADS,GACkD,EADlD,CAVK;;AAatB,QAAI,mCAAW,OAAX,CAAmB,OAAnB,KAA+B,CAAC,CAAD,EAAI;AACrC,UAAM,IAAI,kBAAQ,IAAR,CAAa,IAAb,EAAmB,EAAE,SAAS,IAAT,EAAe,gBAAgB,KAAhB,EAApC,CAAJ,CAD+B;AAErC,gBAAU,EAAE,OAAF,EAAW,IAAX,GAAkB,IAAlB,EAAV,CAFqC;KAAvC;;AAKA,WAAO,EAAE,gBAAF,EAAW,sBAAX,EAAuB,kBAAvB,EAAiC,gBAAjC,EAAP,CAlBsB;GAJR;;;;;;;;AA+BhB,0CAAe,SAAS;AACtB,QAAI,aAAJ;QAAO,gBAAP,CADsB;AAEtB,QAAI;AACF,UAAI,kBAAQ,IAAR,CAAa,OAAb,EAAsB,EAAE,SAAS,IAAT,EAAxB,CAAJ,CADE;AAEF,aAAO,EAAE,SAAF,CAAP,CAFE;KAAJ,CAGE,OAAO,CAAP,EAAU;AACV,YAAM,sBAAe,8BAAf,CAAN,CADU;KAAV;;AAIF,QAAI,CAAC,IAAD,EAAO;AACT,YAAM,0BAAmB,8BAAnB,CAAN,CADS;KAAX;;AAIA,WAAO,UAAU,iBAAV,CAA4B,KAAK,GAAL,CAAS,CAAT,CAA5B,CAAP,CAbsB;GA/BR;CAAZ;;kBAgDS,UAAU,cAAV","file":"documentParser.js","sourcesContent":["import cheerio from \"cheerio\"\nimport { endingTags } from './MJMLElementsCollection'\nimport { ParseError, EmptyMJMLError, NullElementError } from './Error'\n\nconst internals = {\n  /**\n   * converts MJML body into a JSON representation\n   */\n  mjmlElementParser(elem) {\n    if (!elem) {\n      throw new NullElementError('Null element found in mjmlElementParser')\n    }\n\n    const that = internals.mjmlElementParser\n    const tagName = elem.tagName\n    const attributes = elem.attribs\n    let content\n\n    const children = elem.childNodes ?\n            elem.childNodes.filter(child => child.tagName).map(that) : []\n\n    if (endingTags.indexOf(tagName) != -1) {\n      const $ = cheerio.load(elem, { xmlMode: true, decodeEntities: false })\n      content = $(tagName).html().trim()\n    }\n\n    return { tagName, attributes, children, content }\n  },\n\n  /**\n   * Import an html document containing some mjml\n   * returns JSON\n   *   - container: the mjml container\n   *   - mjml: a json representation of the mjml\n   */\n  documentParser(content) {\n    let $, body;\n    try {\n      $ = cheerio.load(content, { xmlMode: true })\n      body = $('mj-body')\n    } catch (e) {\n      throw new ParseError('Error while parsing the file')\n    }\n\n    if (!body) {\n      throw new EmptyMJMLError('No mj-body found in the file')\n    }\n\n    return internals.mjmlElementParser(body.get(0))\n  }\n};\n\nexport default internals.documentParser\n"]}